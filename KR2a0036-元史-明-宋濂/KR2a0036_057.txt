元史卷五十七
明翰林學士亞中大大知制誥兼修國史宋濓等修
志第九
歷六
庚午元歷下
步交會術
交終分一十四萬二十三百一十九秒九千三百六
微二十
交終日二十七餘一千一百九秒九千三百六
微二十
交中日一十三餘三千一百六十九秒四千六百
五十三微一十
交朔日二餘一千六百六十五秒六百九十三
微八十
交望日一十四餘四千二秒五十
秒母一萬
微母一百
交終度三百六十三分七十九秒三十六
交中度一百八十一分八十九秒六十八
交象度九十分九十四秒八十四
半交象度四十五分四十七秒四十二
日食既前限二千四百定法二百四十八
日食既後限三千一百定法三百二十
月限五千一百
月食既限一千七百定法三百四十
分秒母皆一百
求朔望入交(先置里差半之如九而一所得依其加減天正朔積分然後求之)
置天正朔積分以交終分去之不盡如日法而一為日
不滿為餘即得天正十一月中朔入交汎日及餘秒(便為)
(中朔加時入交汎日及餘)交朔加之得次朔交望加之得望再加交
望亦得次朔各為朔望入交汎日及餘秒(几稱餘秒者微亦從之餘)
(倣此)
求定朔及每日夜半入交
各置入交汎日及餘秒減去中朔望小餘即為定朔望
夜半入交汎日及餘秒若定朔望有進退者亦進退交
日否則因中為定大月加二日小月加一日餘皆四千
一百二十秒六百九十三微八十即次朔夜半入交累
加一日滿交終日及餘秒去之即每日夜半入交汎日
及餘秒
求定朔加時入交
置中朔望加時入交汎日及餘秒以入氣入轉朓朒定
數朓朒加之即得定朔望加時入交汎日及餘秒
求定朔望加時入交積度及隂陽歷
置定朔望加時入交汎日以日法通之内餘進二位如
三萬九千一百二十一而一為度不滿退除為分秒即
得定朔望加時月行入交積度以定朔望加時入轉遲
疾度遲減疾加之即為月行入定交積度如交中度以
下為入陽歷積度以上去之為入隂歷積度(每日夜半准此求之)
求月去黃道度
視月入陰陽歷積度及分交象以下為少象以上覆減
交中餘為老象置所入老少象度於上位列交象於下
相減相乘倍之退位為分分滿百為度用減所入老少
象度及分餘又與交中度相減相乘八因之以一百一
十除之為分分滿百為度即得月去黃道度及分
求朔望加時入交常日及定日
置朔望入交汎日以入氣朓朒定數朓減朒加為入交
常日又置入轉朓朒定數進一位以一百二十七而一
所得朓減朒加交常日為入交定日及餘秒
求入交陰陽歷交前後分
視入交定日如交中以下為陽歷以上去之為陰歷如
一日上下以日法通日内分内餘為交後分十三日上
下覆減交中日餘為交前分
求日月食甚定餘
置朔望入氣入轉朓朒定數同名相從異名相消以一
千三百三十七乘之以定朔望加時入轉算外轉定分
除之所得以朓減朒加中朔望小餘為汎餘日食視汎
餘如半法以下為中前半法以上去之為中後置中前
後分與半法相減相乘倍之萬約為分曰時差中前以
時差減汎餘為定餘覆減半法餘為午前分中後以時
差加汎餘為定餘減去半法餘為午後分月食視汎餘
在日入後夜半前如日法四分之三以下減去半法為
酉前分四分之三以上覆減日法餘為酉後分又視汎
餘在夜半後日出前者如日法四分之一以下為夘前
餘四分之一以上覆減半法餘為夘後分其夘酉前後
分自相乘四因退位萬約為分以加汎餘為定餘各置
定餘以𤼵斂加時法求之即得日月食甚辰刻及分秒
求日月食甚日行積度
置朔望食甚大小餘與中朔大小餘相減之餘以加減
中朔望入氣日餘(以中朔望少加多減)即為食甚入氣以加其氣
中積為食甚中積又置食甚入氣餘以所入氣損益率
(盈縮之捐益)乘之如日法而一以損益其日盈縮積盈加縮
減食甚中積即為食甚日行積度及分先以食甚中積
經分為約分然後加減之餘類此者依而求之
求氣差
置日食食甚日行積度及分滿中限去之餘在象限以
下為初限以上覆減中限為末限皆相乘進二位以四
百七十八而一所得用減一千七百四十四餘為氣差
恒數以午前後分乘之半晝分除之所得以減恒數為
定數(如不及減者覆減為定數應加者減之應減者加之)春分後陽歷減隂歷加
秋分後陽歷加隂歷減(春分前秋分後各二日二千一百分為定氣于此宜加減之)
求刻差
置日食食甚日行積度及分滿中限去之餘與中限相
減相乘進二位如四百七十八而一所得為刻差恒數
以午前後分乘之日法四分之一除所得為定數(若在恒數)
(以上者倍恒數以所得之數減之為定數依其加減)冬至後午前陽加隂減午後
陽減陰加夏至後午前陽減陰加午後陽加陰減
求日食去交前後定分
置氣刻二差定數同名相從異名相消為食差依其加
減交前後分為去交前後定分視其前後定分如在陽
歷即不食如在陰歷即有食之如交前陰歷不及減反
減之(反減食差)為交後陽歷交後陰歷不及減反減之為交
前陽歷即不食交前陽歷不及減反減之為交後陰歷
交後陽歷不及減反減之為交前陰歷即日有食之
求日食分
視去交前後定分如二千四百以下為既前分以二百
四十八除為大分二千四百以上覆減五千五百(不足減者)
(不食)為既後分以三百二十餘為大分退為秒(其一分以下者涉交)
(太淺太陽光盛或不見食)
求月食分
視去交前後分(不用氣刻差者)一千七百以下者食既以上覆
減五千一百(不足減者不食)餘以三百四十除之為大分不盡
退除為秒即月食之分秒去交分在既限以下覆減既
限亦以三百四十除之為既内之大分
求日食定用分
置日食之大分與三十分相減相乘又以二千四百五
十乘之如定朔入轉算外轉定分而一所得為定用分
減定餘為初虧分如定餘為復圓分各以發斂加時法
求之即得日食三限辰刻也
求月食定用分
置月食之大分與三十五分相減相乘又以二千一百
乘之如定望入轉算外轉定分而一所得為定用分加
減定餘為初虧復圓分各如發斂加時法求之即得月
食三限辰刻月食既者以既内大分以一十五分相減
相乘又以四千二百乘之如定望入轉算外轉定分而
一所得為既内分用減定用分為既外分置月食定餘
減定用分為初虧分因加既外分為食既分又加既内
分為食甚分(即定餘分是也)再加既内分為生光分復加既外
分為復圓分各以𤼵斂加時法求之即得月食五限辰
刻及分(如月食既者以十分併既内大分如其法而求其定用分也)
求月食所入更點
置食甚所入日晨分倍之五約之為更法又五約之為
點法乃置月食初末諸分昏分以上者減昏分晨分以
下者加晨分如不滿更法為初更不滿點法為一點依
法以次求之即得更點之數
求日食所起
食在既前初起西南甚於正南復於東南食在既後初
起西北甚於正北復於東北其食八分以上者皆起正
西復正東(此據正午地而論之)
求月食所起
月在陽歷初起東北甚於正北復於西北月在陰歷初
起東南甚於正南復於西南其食八分以上皆起正東
復正西(此亦據正午地而論之)
求日月出入帶食所見分數
各以食甚小餘與日出入分相減餘為帶食差以乘所
食之分滿定用分而一(月食既者以既内分減帶食差餘乘所食分如既外分而一不)
(及減者為帶食既出入)以減所食分即日月出入帶食所見之分
(其食甚在晝晨為漸進昏為已退食甚在夜晨為已退昏為漸進也)
求日月食甚宿次
置日月食甚日行積度(望即更加望度)以天正冬至加時黃道
日度加而命之依黃道宿次去之即各得日月食甚宿
度及分秒
步五星術
木星周率二百八萬六千一百四十二秒九
歷率二千二百六十五萬五百五十七
歷度法六萬二千一十四
周日三百九十八日八十八分
歷度三百六十五度二十四分九十秒
歷中一百八十二度六十二分四十五秒
歷策一十五度二十一分八十七秒
伏見一十三度
段目段日平度限度初行率
合伏一十六日(八十六)三度(八十六)二度(九十三)二十三
晨順疾二十八日六度(一十一)四度(六十四)二十二
晨次疾二十八日五度(五十一)四度(一十九)二十一
晨順遲二十八日四度(三十一)三度(二十八)一十八
晨末遲二十八日一度(九十一)一度(四十五)一十二
晨留二十四日
晨退四十六日(五十八)四度(八十八一十八)空度(三十二八十二)
夕退四十六日(五十八)四度(八十八一十八)空度(三十二八十二)一十六
夕留二十四日
夕末遲二十八日一度(九十一)一度(四十五)
夕順遲二十八日四度(三十一)三度(二十八)一十二
夕次疾二十八日五度(五十一)四度(一十九)一十八
夕順疾二十八日六度(一十一)四度(六十四)二十一
夕伏一十六日(八)(六十)三度(八十六)二度(九十三)二十二
策數損益率盈積度損益率縮積度
一益百五十九初益百五十九初
二益百四十二一度(五十九)益一百四十二一度(五十九)
三益一百二十三度(一)益一百二十三度(一)
四益九十三四度(二十一)益九十三四度(二十一)
五益六十一五度(一十四)益六十一五度(一十四)
六益二十四五度(七十五)益二十四五度(七十五)
七損二十四五度(九十九)損二十四五度(九十九)
八損六十一五度(七十五)損六十一五度(七十五)
九損九十三四度(一十四)損九十三五度(一十四)
十損一百二十四度(二十一)損一百二十四度(二十一)
十一損一百四十二三度(一)損一百四十二三度(一)
十二損一百五十九一度(五十九)損一百五十九一度(五十九)
火星周率四百七萬九千四十二秒一十四半
歷率三百五十九萬二千七百五十七秒四十四(少)
歷度法九千八百三十六半
周日七百七十九日九十三分一十六秒
歷度三百六十五度二十四分七十五秒
歷中一百八十二度六十二分三十七秒半
歷策一十五度二十一分八十六秒
伏見一十九度
段目段日平度限度初行率
合伏六十七日四十八度四十五度(四十八)七十二
晨順疾六十三日四十四度(六十)四十二度(二十六)七十二
晨次疾五十八日四十度(一九)三十七度(九十九)七十
晨中疾五十二日三十四度三十二度(三十二)六十八
晨末疾四十五日二十六度(三十二)二十四度(九十九)六十三
晨順遲三十七日一十六度(六十八)一十五度(八十)五十四
晨末遲二十八日五度(七十五)五度(四十五)三十七
晨留一十一日
晨退二十八日(九十六五十八)八度(一十五六十)三度(四十)
夕退二十八日(九十六五十八)八度(一十五六十)三度(五四十)四十一
晨順疾二十七日(五十)三度(二十二)二度一十二
晨次疾二十七日(五十)二度(六十四)一度(六十五)一十一
晨遲二十七日(五十)一度(四十八)空度(九十二)八
晨留三十六日
晨退五十一日(六十一五)三度(三十九六十六)空度(二十八二十三)
夕退五十一日(六十一五)三度(三十九六十六)空度(二十八三十三)九(七十五)
夕留三十六日
夕遲二十七日(五十)一度(四十八)空度(九十二)
夕次疾二十七日(五十)二度(六十四)一度(六十五)八
夕順疾二十七日(五十)三度(二十三)三度(三)一十一
夕伏一十九日(四十八)四度(四十八)一度(五十六)一十二
策數損益率盈積度損益率縮積度
一益二百一十三初益一百六十三初
二益一百九十七二度(一十三)益一百四十八一度(六十三)
三益一百六十八四度(一十)益一百二十八三度(一十三)
四益一百二十八五度(七十八)益一百四度(四十)
五益八十一七度(六)益六十五五度(四十)
六益三十三七度(八十七)益二十三六度(五)
七損三十三八度(二十二)損二十三六度(二十八)
八損八十一七度(八十二)損六十五六度(五)
九損一百二十八七度(六)損一百五度(四十)
十損一百六十八五度(七十八)損一百二十八四度(四十)
十一損一百九十七四度(一十)損一百四十九三度(一十二)
十二損二百一十三二度(一十三)損一百六十三一度(六十三)
金星周率三百五萬三千八百四秒六十三太
歷率一百九十一萬二百四十秒七十六半
歷度法五千二百三十
周日五百八十三日九十分一十四秒
合日二百九十一日九十五分七秒
歷度三百六十五度二十四分六十八秒
歷中一百八十二度六十二分三十四秒
歷策一十五度二十一分八十六秒
十損四十一半一度(四十一半)損四十一半一度(四十一半)
十一損四十八一度損四十八一度
十二損五十二空度(五十二)損五十二空度(五十二)
水星周率六十萬六千三十一秒七十七半
歷率一百九十一萬二百四十二秒一十三半
歷度法五千二百三十
周日一百一十五日八十七分六十秒
合日五十七日九十三分八十秒
歷度三百六十五度二十四分七十秒
歷中一百八十二度六十二分三十五秒
歷策一十五度二十一分八十五秒
晨伏夕見一十四度
夕伏晨見一十九度
段目段日平度限度初行率
合伏一十五日二十九度二十四度(三十六)二百五
夕順疾一十五日二十三度(七十五)一十九度(九十五)一百八十一
夕順遲一十五日一十三度(二十五)一十一度(一十三)一百三十五
夕留二日
夕退伏一十日(九十三八十)八度(六二十)二度(四十九八十)
合退伏一十日(九十三八十)八度(六二十)二度(四十九八十)一百八
晨留二日
晨順遲一十五日一十三度(二十五)一十一度(一十三)
晨順疾一十五日二十三度(七十五)一十九度(九十五)一百二十五
晨伏一十五日二十九度二十四度(三十六)一百八十一
策數損益率盈積度損益率縮積度
一益五十七初益五十七初
二益五十三空度(五十七)益五十三空度(五十七)
三益四十五一度(一十)益四十五一度(一十)
四益三十五一度(五十五)益三十五一度(五十五)
五益二十二一度(九十)益二十二一度(九十)
六益八二度(一十二)益八二度(一十二)
七損八二度(二十)損八二度(二十)
八損二十二二度(一十二)損二十二二度(一十二)
九損三十五一度(九十)損三十五一度(九十)
十損四十五一度(五十五)損四十五一度(五十五)
十一損五十三一度(一十)損五十三一度(一十)
十二損五十七空度(五十七)損五十七空度(五十七)
求五星天正冬至後平合及諸段中積中星
置通積分(先以里差加減之)各以其星周率去之不盡為前合
分覆減周率餘為後合分如日法而一不滿退除為分
秒即得其星天正冬至後平合中積中星(命為日曰中積命為度曰)
(中星)以段日累加中積即為諸段中積以平度累加中星
經退則減之即為段中星
求五星平合及諸段入歷
置通積分各加其星後合分以歷率去之不盡各以其
歷度法除為度不滿退除為分秒即為其星平合入歷
度及分秒以諸段限度累加之即得諸段入歷度及分
秒
求五星平合及諸段盈縮定差
各置其星段入歷度及分秒如在歷中以下為盈以上
為減去歷中餘為縮以其星歷策除之為策數不盡為
入策度及分命數算外以其策損益率乘之如歷策而
一為分以損益其下盈縮積度即為其星段盈縮定差
求五星平合及諸段定積
各置其星段中積以其段盈縮定差盈加縮減之即得
其段定積日及分加天正冬至大餘及約分滿紀法去
之不滿命壬戌算外即得日辰也
求五星平合及諸段所在月日
各置其定積以加天正閏日及約分以朔策及約分除
之為月數不盡為入月以來日數及分其月數命天正
十一月算外即得其段入月中朔日數及分乃以日辰
相距為所在定朔月日
求五星平合及諸段加時定星
各置中星以盈縮定差盈加縮減(金星倍之水星三之然後加減)即為
五星諸段定星以加天正冬至加時黃道日度依宿次
命之即其日其段加時所在宿度及分秒
求五星諸段初日晨前夜半定星
各以其段初行率乘其段定積日下加時分百約之乃
順減即加其日加時定星即其段初日晨前夜半定星
所在宿度及分秒
求諸段日率度率
各以其段日辰距後段日辰為日率以其段夜半宿次
與後段夜半宿次相減餘為度率
求諸段平行分
各置其段度率及分秒以其段日率除之即得其段平
行度及分秒
求諸段總差及日差
本段前後平行分相減為其段汎差(假令求木星次疾汎差乃以順疾順)
(遲平行分相減餘為次疾汎差他皆倣此)倍而退位為增減差加減其平行
分為初末日行分(前多後少者加為初減為末前少後多者減為初加為末)倍增減
差為總差以日率減一除之為日差
求前後伏遲退段增減差
前伏者置後段初日行分加其日差之半為末日行分
後伏者置前段末日行分加其日差之半為初日行分
以減伏段平行分餘為增減差前遲者置前段末日行
分倍其日差減之為初日行分後遲者置後段初日行
分倍其日差減之為末日行分以遲段平行分減之餘
為增減差(前後近留遲段)木火土三星退行者六因平行分退
一位為增減差金星前後伏退者三因平行分半而退
位為增減差前退者置後段初日之行分以其日差減
之為末日行分後退者置前段末日之行分以其日差
減之為初日行分以本段平行分減之餘為增減差水
星平行分為增減差皆以增減差加減平行分為初末
日行分(前多後少加初減末前少後多減初加末)又倍增減差為總差以日
率減一除之為日差
求每日晨前夜半星行宿次
各置其段初日行分以日差累損益之(後少則損之後多則益之)為
每日行度及分秒乃順加退減之滿宿次去之即得每
日晨前夜半星行宿次(視前段末日後段初日行分相較之數不過一二日差為妙或)
(多日差數倍或顛倒不倫當類同前後增減差稍損益之使其有倫然後用之或前後平行分俱多俱少則平)
(注之或總差之秒不盈一分亦平注之若有不倫而平注得倫者亦平注之)
求五星平合及見伏入氣
置定積以氣策及約分除之為氣數不滿為入氣日及
分秒命天正冬至算外即得所求平合及見伏入氣日
及分秒
求五星平合及見伏行差
各以其段初日星行分與太陽行分相減餘為行差若
金在退行水在退合者相併為行差如水星夕伏晨見
者直以太陽行分為行差
求五星定合及見伏汎積
木火土三星各以平合晨疾夕伏定積為定合定見定
伏汎積金水二星置其段盈縮定差(水星倍之)各以行差除
之為日不滿退除為分秒若在平合夕見晨伏者盈減
縮加如在退合夕伏晨見盈加縮減皆以加減定積為
定合定見定伏汎積
求五星定合定積定星
木火土三星各以平合行差除其日大陽盈縮差為距
合差日以太陽盈縮差減之為距合差度日在盈歷以
差日差度減之在縮歷加之加減其星定合汎積為定
合定積定星金水二星順合退合各以平合退合行差
除其日太陽盈縮差為距合差日順加退減太陽盈縮
差為距合差度順在盈歷以差日差度加之在縮歷減
之退在盈歷以差日減之差度加之在縮歷以差日加
之差度減之皆以加減其定星定合再定合汎積為定
合再定合定積定星以冬至大餘及約分加定積滿紀
法去之合得定合日晨以冬至加時黃道日度加定星
滿宿次去之即得定合所在宿次(其順退所在盈縮即太陽盈縮)
求木火土三星定見伏定日
各置其星定見伏汎積晨加夕減象限日及分秒(半中限為)
(象限)如中限以下自相乘以上覆減歲周日及分秒餘亦
自相乘滿七十五而一所得以其星伏見度乘之一十
五除之為差其差如其段行差而一為日不滿退除為
分秒見加伏減汎積為定積加命如前即得日辰
求金水二星定見伏定日
各以伏見日行差除其日太陽盈縮差為日若晨伏夕
見日在盈歷加之在縮歷減之如夕伏晨見日在盈歷
減之在縮歷加之加減其星汎積為常積視常積如中
限以下為冬至後以上去之餘為夏至後其二至後如
象限以下自相乘以上覆減中限餘亦自相乘各如法
而一(冬至後晨夏至後夕以一十八為法冬至後夕夏至後晨以七十五為法)以伏見度乘
之一十五除之為差其差滿行差而一為日不滿退除
為分秒加減常積為定積(冬至後晨見夕伏加之夕見晨伏減之夏至後晨見夕伏)
(減之夕見晨伏加之)加命如前即得定見伏日晨
其水星夕疾在大暑氣初日至立冬氣九日三十五分
以下者不見晨留在大寒氣初日至立夏氣九日三十
五分以下者不見春不晨見秋不夕見者亦舊歷有之
元史卷五十七
元史卷五十七考證
求朔望加時入交常日及定日按定日原刻脱日字
今據正文增
日在盈歷以差日差度减之按盈歷原刻作盈縮今
據文義改
求刻差按原刻標目脱差字今據正文增
