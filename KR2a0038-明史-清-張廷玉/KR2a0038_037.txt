欽定四庫全書
明史卷三十七
大學士張廷玉等奉敕修
志第十三
歷七
回回歷法一
回回歷法西域默狄納國王馬哈麻所作其地北極高
二十四度半經度偏西一百七度約在雲南之西八
千餘里其歷元用隋開皇己未即其建國之年也洪武
初得其書於元都十五年秋太祖謂西域推測天象最
精其五星緯度又中國所無命翰林李翀吳伯宗同回
回大師馬沙亦黑等譯其書其法不用閏月以三百六
十五日為一歲歲十二宫宫有閠日凡百二十八年而
宫閠三十一日以三百五十四日為一周周十二月月
有閠日凡三十年月閠十一日歷千九百四十一年宫
月日辰再會此其立法之大概也按西域歷術見於史
者在唐有九執歷元有札馬魯丁之萬年歷九執歷最
疎萬年歷行之未久唯回回歷設科隸欽天監與大統
參用二百七十餘年雖於交食之有無深淺時有出入
然勝於九執萬年遠矣但其書多脱誤蓋其人之隸籍
臺官者類以土盤布算仍用其本國之書而明之習其
術者如唐順之陳壤袁黃輩之所論著又自成一家言
以故翻譯之本不行於世其殘缺宜也今為博訪專門
之裔考究其原書以補其脱落正其訛舛為回回歷法
著於篇
積年起西域阿喇必年(隋開皇己未)下至洪武甲子七百
八十六年
用數天周度三百六十(每度六十分每分六十秒微纖以下俱凖此)宫十
二(每宫三十度)日周分一千四百四十時二十四(每時六十分)刻
九十六(每刻十五分)宫度起白羊節氣首春分命時起午正
(午初四刻屬前日)
七曜數日一月二火三水四木五金六土七(以七曜紀日不
用甲子)
宫數白羊初金牛一隂陽二巨蟹三獅子四雙女五
天秤六天蝎七人馬八磨羯九寳瓶十雙魚十一
宫日白羊戍宫三十一日金牛酉宫三十一日隂陽
申宫三十一日巨蟹未宫三十二日獅子午宫三十一
日雙女巳宫三十一日天秤辰宫三十日天蝎卯宫三
十日人馬寅宫二十九日磨羯丒宫二十九日寳瓶子
宫三十日雙魚亥宫三十日(已上十二宫所謂不動之月凡三百六十五日乃歲
周之日也若遇宫分有閏之年於雙魚宫加一日凡三百六十六日)
月分大小單月大雙月小(凡十二月所謂動之月也月大三十日月小二十九
日凡三百五十四日乃十二月之日也遇月分有閠之年於第十二月内增一日凡三百五十五日)
太陽五星最高行度(隋已未測定)太陽二宫二十九度二十
一分土星八宫十四度四十八分木星六宫初度八分
火星四宫十五度四分金星二宫十七度六分水星七
宫六度十七分
求宫分閠日(炁之餘日)置西域歲前積年減一以一百五
十九乘之(一百二十八年内閏三十一日故以總數乘)内加一十五(閏應)以一
百二十八屢減之餘不滿之數若在九十七已上(閏限)其
年宫分有閏日已下無閏日於除得之數内加五(宫分立成
起火三故須加五)滿七去之餘即所求年白羊宫一日七曜(有閏
加一日後同)
求月分閏日(朔之餘日)置西域歲前積年減一以一百三
十一乘之(總數乘)内加一百九十四(閏應)以三十為法屢減
之餘在十九以上(閏限)其年月分有閏日已下則無於除
得之數滿七去之餘即所求年第一月一日七曜
加次法置積日(全積并宫閏所得數)減月閏内加三百三十一
日(已未春正前日)以三百五十四(一年數)除之餘數内減去所加
三百三十一又減二十三(足成一年日數)又減二十四(洪武甲子加次)
又減一(改應所損之一日)為實距年(己未至今)得數又法以氣積
(宫閏併通閏為氣積)内減月閏(置十一以距年乘之外加十四以三十除之得月閏數)以三
百五十四除之餘減洪武加次二十四又減補日二十
三又減改應損日一得數如前(求通閏置十一日以距年乘之求宫閏前見)
太陽行度
求最高總度置西域歲前積年入總年零年月分日
期立成内各取前年前月前日最高行度併之(如求十年則取
九年之類蓋立成中行度俱本年本月日足數也如十年竞求十年則逾數矣月日義同後倣此)
求最高行度置求到最高總度加測定太陽最高行
度(二宫二十九度二十一分)即所求年白羊宫最高行度如求次宫
累加五秒六微求次月加四秒五十六微
求中心行度(日平行度)置積年入總年零年月日立成内
各取日中心行度併之(取法同前)内減一分四秒即所求白
羊宫第一日中心行度求各宫月日按每日行度(五十九分
八秒)累加之(内減一分四秒或云西域距中國里差非是盖係已未年之宫分末日度應也)求自行度置其日中心行度減其宫最高行度即得
(即入盈縮歷度也)
求加減差(即盈縮差)以自行宫度為引數入太陽加減立
成内照引數宫度取加減差(是名未定差)其度下小餘用比
例法以本度加減差與後度加減差相減餘數通為秒
(加一分通為六十秒)與引數小餘(亦通秒)相乘得數為纖(秒乘秒得纖)以
六十收之為微為秒為分(如數多先以六十收之為微又以六十收之為秒又以六
十收之為分)視前所得未定加減差數較少於後數者(後度加減
差)加之多於後數者減之是為加減定差分(如無小餘竟用未定
差為定差後凖此)
求經度(黃道度)置其日中心行度以加減定差分加減
之(視定差引數自行宫度在初宫至五宫為減差六宫至十一宫為加差)即得
求七曜置積年入立成内取總年零年月日下七曜
數併之累去七數餘即所求白羊宫一日七曜如求次
宫者内加各宫七曜數如求逐日累加一數滿七去之
(求太隂五星羅計七曜竝凖此)
太隂行度
求中心行度置積年入立成内取總零年月日下中
心行度併之得數内減一十四分(已未應轉)即所求年白羊
宫一日中心行度如求逐日累加日行度(十三度一三五)
求加倍相離度(月體在小輪行度合朔後□日相離)置積年入立成内
取總年零年月日下加倍相離度併之内減二十六分
即所求白羊宫一日度也如求逐日累加倍離日行度
(二十四度二二五三二二半之即小輪心離太陽數)
求本輪行度(即月轉度)置積年入立成内取總零年月日
下本輪行度併之内減一十四分即所求白羊宫一日
度也如求各日累加本輪日行度(十三度三分五四)
求第一加減差(又名倍離差)以加倍相離宫度為引數入
太隂第一加減立成内取加減差(未定差)又與下差相減
餘乘引數小餘得數為秒(分乘分)以六十收之為分用加
減未定差(後差多加少減同太陽)得第一差分
求本輪行定數置其日本輪行度以第一差分加減
之(視倍離度前六宫加後六宫減)
求第二加減差以本輪行定度為引數入太隂第二
加減立成内取未定差依比例法(同前)求得零數加減之
為第二加減差分(視引數六宫已前為減差後為加差)
求比敷分以倍離宫度入第一加減立成内取比敷
分加倍離零分在三十分已上者取下度比敷分
求遠近度以本輪行定宫度為引數入太隂第二加
減立成内取遠近度分其引數零分亦依比例法取之
求汎差定差置比敷分以遠近度通分乘之以六十
約之為分即汎差以汎差加入第二加減差即為定差
求經度置其曰太隂中心行度以定差加減之即太
隂經度(視本輪行定度六宫以前減以後加)
太隂緯度
求計都與月相離度(入交定度)置其日太隂經度内減其
日計都行度(即羅計中心度)即計都與月相離度分
求緯以計都與月相離宫度為引數入太隂緯度立
成(上宫用右行順度下宫用左行逆度)取其度分依此例法求得零分加
減之(上六宫加下六宫減)得緯度分(引數在六宫已前為黃道北六宫後為黃道南)
求計羅行度置積年入總年零年月日立成内取羅
計中心行度併之為其年白羊宫一日行度求各宫一
日以各宫日行度加之與十二宮相減餘即所求宫一
日計都行度如求計都逐日細行以前後二段行度相
減餘以相距日數除之為日差又置前叚計都行度以
日差累減之如求羅㬋行度置其日計都行度内加六
宫
五星經度
求最高總度數同太陽依前太陽術求之
求最高行度置所求本星最高總度加測定本星最
高行度(見前)為其年白羊宫最高行度求各宫各日加各
宫日行度
求日中心行度依太陽術求之
求自行度置積年入立成總零年月日下各取自行
度併之得其年白羊宫一日自行度土木金三星減一
分水星減三分火星不減如求各宫各日照本星自行
度累加之水星如自行度遇三宫初度作五日一叚算
至九宫初度作十日一段算緯度亦然
求中心行度小輪心度(即入歷度五星本輪)土木火三星置太
陽中心行度減其星自行度為三星中心行度内又減
最高行度為三星小輪心度金水二星其中心行度即
太陽中心行度内減其星最高行度餘為其星小輪心
度(不及減加十二宫減之)
求第一加減差(盈縮差)以其心小輪心宫度為引數入
本星第一加減立成依比例法求之(法同太陽太隂)
求自行定度及小輪心定度視第一加減差引數在
初宫至五宫用加減差加自行度減小輪心度各為定
度在六宫至十一宫用加減差減自行度加小輪心度
各為定度
求第二加減差以其星自行定度入本星第二加減
立成内取其度分用比例法加減之(同前)
求比敷分如土木金水星以本星小輪心定宫度入
第一加減立成内取比敷分如引數小餘在三十分已
上取後行比敷分如火星則必用比例法求之
求遠近度以自行定宫度入第二加減立成内取遠
近度依比例法求之
求汎差定差法同太隂
求經度置小輪心定度以定差加減之(視引數自行定度在六宫
已前加已後減)内加其星最高行度
求留段以其留段小輪心定宫度為引數(即立成内各星入歷
定限)入五星順退留立成内於同宫近度取本星度分與
前後行相減(若取得在初宫至六宫本行與後行相減六宫至初宫本行與前行相減)又以
引數宫度減立成内同宫近度两減餘通分相乘用六
度除之(立成内每隔六度)六十分收之順加逆減於前取度分
得數與其日自行定度同者即本日留如自行定度多
者已過留日少者未到留日欲得細率以所得數與其
日自行定度相減餘以各星一日自行度約之(土星留一日自
行五十七分有奇之類)即得留日在本日前後數也(土星留七日其留日前三
日後三日皆與留日數同木星留五日其留日前二日後二日與留日數同火金水三星不留退而即行徐而
即退但於行分極少處為留耳)
求細行分土木金火四星以前後兩段經度相減以
相距日除之為日行分水星以白羊宫初日經度又與
前一日經度相減餘為初日行分又置前後二段經度
相減餘以相距日除之為平行分與初日行分加減倍
之以前段前一日與後段相距日數除之為日差以加
減初日行分(初十行分少於平行分加多減)為日行分五星各置前段
經度以逐日行分順加退減之為各星逐日經度
求伏見視各星自行定度在伏見立成内限度已上
者即五星晨夕伏見也
五星緯度(求最高總行度中心行度自行度小輪心度並依五星經度術求之)
求自行定度置自行宫度分其宫以一十乘之為度
(加一宫以十乘之得十度此用約法折算以造緯度立成)其度以二十乘之為分滿
六十約之為度其分亦以二十乘之為秒滿六十約之
為分併之即得
求小輪心定度置小輪心宫度分其宫以五乘之為
度(如一宫以五乘之得五度)其度以一十乘之為分滿六十約之為
度其分亦以一十乘之為秒滿六十約之為分併之即
得
求緯度以小輪心定度及自行定度入本星緯度立
成内兩取(一縱一横)得數與後行相減(若遇交黃道者與後行相併)又以
小輪心定度與立成上小輪心定度相減(上横行)兩減餘
相乘以立成上小輪心度累加數除之(如土心上横行小輪心度每隔
三度火星每隔二度之類)滿六十收之為分用加減兩取數(多於後行減少
加若遇交黃道者即後行數多亦減)寄左復以自行定度與立成上自行
定度相減(首直行)又以兩取數與下行相減(若遇交黃道者與下行併)
兩減餘相乘以立成上自行度累加數除之(加土星直行自行度
每隔十度火星每隔四度之類)收之為分與前寄左數相加減(如兩取數多於
下行者減少加若遇交黃道者所得分多於寄左數置所得分内減寄左數餘為交過黃道南北分也)即
得黃道南北緯定分
求緯度細行分置其星前段緯度與後叚緯度相減
餘以相距日除之為日差置前段緯度以日差順加退
減即逐日緯度分(按緯度前段少於後段者以日差順加退減若前叚多於後叚者宜以日
差順減退加非可一例也)若前後段南北不同者置其星前後段緯
度併之以相距日除之為日差置前段緯度以日差累
減之至不及減者於日差内減之餘以日差累加之即
得逐日緯度
推日食法(日食諸數如午前合朔用前一日數推午後合朔用次日數推)
辨日食限視合朔太隂緯度在黃道南四十五分以
下黃道北九十分已下為有食若合朔為晝則全見食
若合朔在日未出三時及日已八十五分(一時四分之一)皆有
帶食若合朔在夜刻者不算
求食甚汎時(即合朔)置午正太隂行過太陽度(求法見後月食
太隂逐時行過太陽分)通秒以二十四乘之為實置太隂日行度
減太陽日行度通秒為法除之為時時下零數以六十
通之為分分下零數以六十通之為秒三十秒已上收
為一分六十分收為一時共為食甚汎時
求合朔太陽經度以食甚汎時通分以太陽日行度
通秒乘之以二十四除之為微滿六十約之為秒為分
用加減午正太陽度(午前合朔減之午後加之)得合朔時太陽經度
(即食甚日躔黃道度)
求加減分視合朔時太陽宫度入晝夜加減立成内
取加減分依比例法求之
求子正至合朔時分秒置食甚汎時以加減分加減
之(午前合朔減午後加)用加減十二時(午前合朔用減十二時午後用加十二時)即子
正至合朔時分秒(按命時起子正乃變其術以合大統非其本法也)
求第一東西差(經差)視合朔時太陽宫在立成(經緯時加減立
成)右七宮取上行時(順行)在左七宫取下行時(逆行)以子正
至合朔時取經差依比例法求之(止用時下小餘求之下同)為第一
東西差
求第二東西差視合朔時太陽宫在立成内(同上)取次
宫子正至合朔時經差依比例法求之為第二東西差
求第一南北差(緯差)以合朔時太陽宫及子正至合朔
時入立成内(同上)取緯差依比例法求之為第一南北差
求第二南北差以合朔太陽宫取次宫子正至合朔
時緯差依比例法求之為第二南北差
求第一時差以合朔太陽宫及子正至合朔時入立
成取時差依比例法求之
求第二時差以合朔太陽宫取次宫子正至合朔時
時差依比例法求之
求合朔時東西差以第一東西差與第二東西差相
減餘通秒以乘合朔時太陽度分(亦通秒)以三十度除之
為纖以六十收之為微為秒為分以加減第一東西差
(視第一東西差數少於第二差者加之多者減之下同)為合朔時東西差
求合朔時南北差以第一南北差與第二南北差相
減餘通秒以乘太陽度分以三十除之為纖依率收之
為微秒分以加減第一南北差為合朔時南北差
求合朔時差以第一第二兩時差相減乘太陽度分
以三十除之依率收之用加減第一時差為合朔時差
求合朔時本輪行度以本輪日行度(一十三度四分)通分以
乘食甚汎時(亦通分)以二十四除之為秒依率收之為分
為度以加減午正本輪行度(午前減午後加)為合朔時行度
求比敷分以本輪行度入立成(太陽太隂晝夜時行景徑分立行)取
同宫近度太隂比敷分依比例法求之
求東西定差置合朔時東西差通秒以比敷分通秒
乘之為纖以六十收之為微為秒為分以加合朔東西
差(有加無減)為定差
求南北定差法同東西定差
求食甚定時(即食甚定分)視其日合朔時太陽度在立成
(經緯時加減立成)左七宫其時差黑字減白字加在右七宫白
字減黑字加皆加減於子正至合朔時得數命起子正
減之得某時初正餘通為秒以一千乘之以一百四十
四除之(六十分為一時每日一千四百四十分故以千乘之又以一四四除之)以六十約
之滿百為刻即食甚定時
求食甚太隂經度於合朔太陽經度内加減東西定
差即得食甚太隂經度(其加減視食甚定時時差加減)
求合朔計都度置食甚汎時通分以計都日行度(三分
一十一秒)通秒乘之以二十四除之為微滿六十收之為秒
為分以加減其日午時計都行度(羅計逆行午前合朔加午後減)為合
朔時計都度
求合朔太隂緯度食甚時太隂經度内加減合朔時
計都度餘為計都與月相離度入太隂經度立成取之
求食甚太隂緯度南北定差内加減合朔時太隂緯
度(在黃道南加北減)得食甚緯度
求合朔時太陽自行度用太陽日行度(五十九分八秒)通秒
以乘食甚汎時(亦通分)用二十四除之得數為微滿六十
收之為秒為分以加減其日午正自行度(午前合朔減午後加)得
合朔自行度
求太陽徑分以合朔太陽自行度為引數入立成(影徑
分立成)内同宫近度取太陽徑分依比例法求之
求太隂徑分以合朔時本輪行度為引數入立成(同上)
内取同宫近度太隂徑分依比例法求之
求二半徑分併太陽太隂兩徑分半之
求太陽食限分置二半徑分内減食甚太隂緯度餘
為太陽食限(如不及減者不食如太隂無緯度者食既如太隂無緯度而日徑大於月徑者食有
金環)
求太陽食甚定分以太陽食限分通秒以一千乘之
為實以太陽徑分通秒為法除之以百約之為分為太
陽食甚定分
求時差(即定用分)食甚太隂緯度通秒自乘二半徑分亦
通秒自乘兩自乘數相減餘以平方開之以二十四乘
之為實以其日太隂日行度内減太陽日行度通分為
法實如法而一得數為分滿六十分為一時為時差
求初虧置食甚定時内減時差餘時命起子正減之
得初正時餘分通秒以一千乘之以一百四十四除之
以六十約之滿百為刻為初虧時刻
求復圓置食甚定時内加時差命起子正如初虧法
得復圓時刻
求初虧食甚復圓方位與大統法同
推月食法(月日諸數午前望用前一日推午後望用次一日推)
辨月食限視望日太隂經度與羅㬋或計都度相離
一十三度之内太隂緯度在一度八分之下為有食又
視合望在太隂未出二時未入二時其限有帶食其在
二時已上者不算
求食甚汎時(即經望)置其日太隂經度内減六宫(如不及減
加十二宫減)以減其日午正太陽度為午前望(如太陽度不及減加入六
宫減之為午後望)置相減餘數通秒以二十四乘之為實置其
日太隂經度内減前一日太隂經度(若在午後望者減後一日太隂經度)
餘為太隂日行度又置其日午正太陽度内減前一日
午正太陽度(若在午後望者減後一日太陽度)餘為太陽日行度兩日
行度相減餘通秒為法除實得數為時其時下餘數以
六十通之為分秒即所求食甚汎時
求食甚月離黃道宫度置食甚汎時與太陽日行度
俱通秒相乘以二十四除之得數為□滿六十收之為
微為秒為分以加減其日午正太陽度(午前望減午後望加)為望
時太陽度加六宫即得所求
求晝夜加減差以望時太陽宫度為引數入晝夜加
減立成内取加減分依比例法求之
求食甚定時置食甚汎時以晝夜加減差加減之(午前
望減午後望加)得數用加減一十二時(如午後望加十二時午前望與十二時相減)
命起子正得初正時其小餘如法收為刻(法詳日食)得定時
求望時計都度置食甚汎時通秒為實以計都日行
度(三分一十一秒)通秒乘之以二十四除之得數為□以六十
收之為微為秒為分用加減其日午正計都行度(羅計逆行
午前望加午後望減)即得
求望時太隂緯度置食甚月離黃道度内減望時計
都度(如不及減加十二宫減)餘為計都與月相離度入太隂緯度
立成取之
求望時本輪行度(即入遲疾歷)置太隂本輪日行度(十三度四
分)通分以食甚汎時通秒乘之以二十四除之為微以
六十收之為秒為分為度用加減其日午正本輪行度
(午前望減午後加)即得
求太隂徑分以望時本輪行宫度入影徑分立成求
之(法祥日食)
求太隂影徑分以望時本輪行宫度入影徑分立成
取之
求望時太陽自行度以太陽日行度(五十九分八秒)與食甚
汎時俱通秒相乘以二十四除之得數為□滿六十收
之為微為秒為分以加減其日午正太陽自行度(法同日食
求太陽經度)
求影徑減差以其日太陽自行宫度為引數入影徑
立成内於同宫近度取太隂影徑差分依比例法求之
(法詳前)
求影徑定分置太隂影徑分内減影徑減差分
求二半徑分置太隂徑分加影徑定分半之
求太隂食限置二半徑分内減望時太隂緯度(如不及減
不食)
求食甚定分置食限分通秒以一千乘之為實以太
隂徑分通秒為法除之以百約之為分為食甚定分
求太隂逐時行過太陽分置太隂望時經度減前一
日太隂經度又置望時太陽自行度減前一日太陽自
行度以兩餘數相減為太隂晝夜行過太陽度通秒以
二十四除之滿六十收之得逐時行過太陽分
求時差以太隂緯度分通秒自乘又以二半徑分通
秒自乘兩數相減餘開平方為實以太隂行過太陽度
通秒為法除之得數即時差(即初虧至食甚定用分)
求初虧復圓時刻以時差減食甚定時得初虧時刻
加食甚定時得復圓時刻其命時收刻之法竝同日食
求食既至食甚時差置二半徑分減太隂徑分通秒
自乘又置太隂緯度亦通秒自乘相減平方開之為實
以太隂逐時行過太陽度通秒為法除之得數即時差
求食既生光時刻以食既至食甚時差減食甚定時
為食既時刻加食甚定時為生光時刻
求初虧食甚復圓方位與大統時同
求日出入時以午正太陽經度為引數入西堿晝夜
時立成取其度分依比例法求之為未定分又於引數
相對宫度内取其度分(如初宫三度向六宫三度取之)亦依比例法求
之為後未定分兩未定分相減(不及減加三百六十度減)餘通秒用
十五除之六十收之為分為時得其日食時分秒半之
為其日半晝時分秒以半晝時分秒減十二時餘為日
出時分秒加十二時為日入時分秒
求日月出入帶食分秒視其日日出時分秒併日入
時分秒較多於初虧時分秒少於食甚定時及復圓時
分秒者即有帶食置其日日出時或日入時與日甚定
時分秒相減餘為帶食差置日月食甚定分以帶食差
通秒乘之以時差通秒除之得數為帶食分於食甚定
分内減帶食分餘為日月帶食所見之分
求月食更點置二十四時内減晝時又減晨昏時(七十
二分即中歷之五刻弱也)餘為夜時通秒五約之為更法五分更法
為點法如食在子正以前者置初虧食甚復圓等時内
減日入時又減半晨昏時(三十六分)餘通秒以更法減之為
更數不滿更法者以點法減之為點數食在子正已後
者置夜時半之如初虧食甚復圓等時以更法減之為
更數不滿更法者以點法減之為點數皆命起初更初
點(更法減之減一次為一更其減餘不滿法者亦虚命為一更點法倣此)
太隂五星凌犯
求太隂晝夜行度以本日經度與次日經度相減餘
即本日晝夜行度
求太隂晨昏刻度置其日午正太隂經度内加立成
(太隂出入晨昏加減立成)其日昏刻加差即為其日太隂昏刻經度
置其次日午正太隂經度減立成其日晨刻減差即為
其日太隂晨刻經度
求月出入度置其日午正太隂經度加立成内(即前立成)
其日月入加差即為其日月入時太隂經度入立成内
其日月出加差即其日月出時太隂經度
求太隂所犯星座朔後視昏刻度至月入度望後視
月出度至晨刻度入黃道南北各像星立成内經緯度
相近在一度已下者取之
求時刻置其日午正太隂經度與取到各像星經度
相減通分以二十四乘之以太隂晝夜行度(亦通分)除之
得初正時其小餘以六十通之為分以一千乘之一百
四十四除之以百約之為刻即得所求時刻
求上下相離分置太隂緯度與所犯星緯度相減餘
為上下相離分若月星同在南月多為下離月少為上
離同在北月多為上離少為下離若南北不同月在北
為上離南為下離
求各星凌犯五星相離分置其日五星經緯度入黃
道立成内視各像内外星經緯度在一度已下者取之
其五星緯度與各星緯度相減餘即上下相離分
求月犯五星五星相犯視太隂經緯度五星經緯度
相近在一度已下者取之
明史卷三十七
